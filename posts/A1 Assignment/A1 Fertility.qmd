---
title: "A1Fertility"
---

```{r}
library(tidyverse) # Sine qua non
library(mosaic) # Out all-in-one package
library(ggformula) # Graphing package
library(skimr) # Looking at Data
library(janitor) # Clean the data
library(naniar) # Handle missing data
library(visdat) # Visualise missing data
library(tinytable) # Printing Static Tables for our data
library(DT) # Interactive Tables for our data
library(crosstable) # Multiple variable summaries
```

```{r}
fertility <- readr::read_csv("../data/fertility.csv") 
  ##janitor::clean_names(case = "snake")
dim(fertility)
dplyr::glimpse(fertility)
```

```{r}
utils::str(fertility)
```

```{r}
fertility <- fertility %>% 
 dplyr::mutate(across(where(is.character), as.factor)) %>% 
  dplyr::relocate(where(is.factor), .after = rownames)

glimpse(fertility)
```

```{r}
fertility %>%
  head(10) %>%
  tinytable::tt(caption = "Fertility (Clean)") %>%
  tinytable::theme_html(class = "table table-hover table-striped table-condensed") %>%
  style_tt(fontsize = 0.8) %>%
  stats::setNames(c(" Serial No.","More Kids", "Gender 1", "Gender 2", "Afam", "Hispanic", "Other", "Age", "Work"))
```

```{r}
fertility %>% mosaic::inspect()
```

```{r}
fertility %>% skimr::skim()
```

```{r}
fertility %>%
  dplyr::count(across(.cols = c(morekids, gender1))) %>%
  tt()
```

```{r}
fertility %>%
  count(across(where(is.factor))) %>% 
  tt()
```

```{r}
# Single Variable, Multiple Summaries
fertility %>%
  dplyr::summarise(
    mean_visits = mean(work, na.rm = T),
    sd_visits = sd(work, na.rm = T),
    min_visits = min(work, na.rm = T),
    max_visits = max(work, na.rm = T)
  )
```

```{r}
# Multiple Variables, Multiple Summaries
fertility %>%
  dplyr::summarise(across(
    .cols = c(work, age), # select columns

    .fns = list(
      mean = ~ mean(., na.rm = T),
      sd = sd,
      min = min, max = max
    )
  ))
```

```{r}
fertility %>%
  group_by(gender1) %>%
  summarize(average_work = mean(work), count = n())
```

```{r}
fertility %>% 
  group_by(morekids , afam) %>% 
  summarise(
    mean_age = mean(age),
    average_work = mean(work),
    count = n()
  )
```

**This graph plots the comparison between mothers are/are not African American and have/ don't have more than two kids**

```{r}
fertility%>%
  gf_bar(~afam,
    fill = ~morekids,
    position = "dodge"
  ) %>%
  gf_labs(title = "Plot A: Dodged Bar Chart") %>%
  gf_refine(scale_fill_brewer(palette = "Set1"))
```

#### **What did I find surprising?**

The graph clearly shows most of the mothers in this data set do not belong to the African American community and most of them do not have more than two kids. The Afam community have almost similar responses for having not more than two kids and having more than two kids.

**This graph plots the comparison between mothers who have/don't have more than two kids by age**

```{r}
gf_bar(~age, fill = ~morekids, data = fertility) %>%
  gf_labs(title = "Plot B: Counts of More kids by age") %>%
  gf_refine(scale_fill_brewer(palette = "Set1"))
```

#### **What did I find surprising?**

The graph interestingly shows the uniform rise in number of mothers as the age increases with almost equal responses of whether they have more than two kids or not.

#### **The two sets of graphs plot the facets between count of mothers**(**have/don't have** more than two kids) **by gender1 and gender2 with increasing age factor**

```{r}
## This is better!
gf_bar(~ gender1 | age, fill = ~morekids, data = fertility) %>%
  gf_labs(
    title = "Plot C: Counts of mothers(2 or more kids) by  different weeks worked in 1979",
    subtitle = "Facetted by every week"
  ) %>%
  gf_refine(scale_fill_brewer(palette = "Set1"))
```

```{r}
## This is better!
gf_bar(~ gender2 | age, fill = ~morekids, data = fertility) %>%
  gf_labs(
    title = "Plot D: Counts of mothers(2 or more kids) by  different weeks worked in 1979",
    subtitle = "Facetted by every week"
  ) %>%
  gf_refine(scale_fill_brewer(palette = "Set1"))
```

#### What did I find surprising?

Both the graphs show similar outcomes for mother with or without more than two kids and genders of the first and the second kid. Did R use "combination" to plot this graph?

Overall Summary

The data reveals that most mothers are not African American and usually have two or fewer children, with African American mothers displaying balanced counts for family size. There is a steady increase in mother count with age, consistent across groups by family size. Graphs comparing child gender combinations show similar trends regardless of whether mothers have more than two kids, suggesting combined categorical plotting methods were employed in R to visualize these relationships effectively.
